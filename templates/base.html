<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>{% block title %}Expense Tracker{% endblock %}</title>

<style>
/* ---------- BRIGHT THEME (LIGHT DEFAULT) ---------- */
:root {
  --primary:#6366f1;
  --accent:#0ea5e9;
  --accent-2:#22c55e;

  --danger:#dc2626;
  --danger-text:#b91c1c;

  --nav-bg:#ffffff;
  --border:#e5e7eb;

  --text-main:#111827;
  --text-muted:#6b7280;

  --page-bg-1:#eef2ff;
  --page-bg-2:#e0f2fe;

  --card-bg:#ffffff;

  --success-bg:#d1fae5;
  --success-text:#065f46;
  --error-bg:#fee2e2;
  --error-text:#7f1d1d;
}

/* ---------- DARK THEME ---------- */
[data-theme="dark"] {
  --primary:#818cf8;
  --accent:#38bdf8;
  --accent-2:#4ade80;

  --nav-bg:#0f172a;

  --text-main:#e5e7eb;
  --text-muted:#9ca3af;

  --page-bg-1:#020617;
  --page-bg-2:#020617;

  --card-bg:#111827;

  --border:#1f2937;

  --success-bg:#052e16;
  --success-text:#86efac;
  --error-bg:#3f0d12;
  --error-text:#fecaca;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:"Segoe UI",Tahoma,Verdana,sans-serif;
  background:linear-gradient(135deg,var(--page-bg-1),var(--page-bg-2));
  min-height:100vh;
  color:var(--text-main);
}

/* ---------- NAVBAR ---------- */
.navbar{
  position:sticky;
  top:0;
  height:72px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 20px;
  background:var(--nav-bg);
  border-bottom:3px solid;
  border-image:linear-gradient(90deg,var(--primary),var(--accent),var(--accent-2)) 1;
  box-shadow:0 6px 14px rgba(0,0,0,.12);
  z-index:1000;
}

.logo{
  font-size:20px;
  font-weight:800;
  background:linear-gradient(90deg,var(--primary),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* ---------- NAV LINKS ---------- */
.nav-links{
  display:flex;
  gap:20px;
  align-items:center;
}

.nav-links a{
  font-size:14px;
  font-weight:600;
  color:var(--text-muted);
  text-decoration:none;
  position:relative;
  padding:6px 2px;
}

.nav-links a:hover{color:var(--primary)}

.nav-links a::after{
  content:"";
  position:absolute;
  left:0;bottom:-6px;
  width:0;height:3px;
  background:linear-gradient(90deg,var(--primary),var(--accent));
  transition:.2s;
  border-radius:3px;
}

.nav-links a:hover::after{width:100%}

.nav-links a.delete{color:var(--danger-text)}
.nav-links a.logout{color:var(--danger)}

/* ---------- THEME DROPDOWN ---------- */
.theme-select{
  border:1px solid var(--border);
  background:transparent;
  padding:6px 10px;
  border-radius:8px;
  font-size:13px;
  cursor:pointer;
  color:var(--text-muted);
}
.theme-select option{color:#000}

/* ---------- MOBILE NAV ---------- */
.menu-btn{display:none;font-size:22px;cursor:pointer}

@media(max-width:820px){
  .nav-links{
    position:fixed;
    top:72px;right:0;
    width:240px;
    height:calc(100vh - 72px);
    flex-direction:column;
    padding:20px;
    background:var(--card-bg);
    transform:translateX(100%);
    transition:.25s;
    box-shadow:-10px 0 28px rgba(0,0,0,.25);
  }
  .nav-links.open{transform:translateX(0)}
  .menu-btn{display:block}
}

/* ---------- LAYOUT ---------- */
.container{
  min-height:calc(100vh - 72px);
  padding:30px;
  display:flex;
  justify-content:center;
}

.content-wrapper{
  width:100%;
  max-width:1200px;
}

.alert{
  padding:14px 18px;
  border-radius:10px;
  margin-bottom:18px;
  font-size:14px;
  font-weight:600;
}

.alert.success{background:var(--success-bg);color:var(--success-text)}
.alert.error{background:var(--error-bg);color:var(--error-text)}

.card{
  background:var(--card-bg);
  border-radius:14px;
  padding:28px;
  box-shadow:0 18px 40px rgba(0,0,0,.2);
  animation:fadeIn .35s;
}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(8px)}
  to{opacity:1;transform:translateY(0)}
}
</style>
</head>

<body>

<nav class="navbar">
  <div class="logo">üí∞ ExpenseTracker</div>

  <span class="menu-btn" onclick="toggleMenu()">‚ò∞</span>

  <div class="nav-links" id="navMenu">
    <a href="/ExpenseTracker/Home">Home</a>
    <a href="/ExpenseTracker/AddExpense">Add Expense</a>
    <a href="/ExpenseTracker/GetExpenses">View Expenses</a>
    <a href="/ExpenseTracker/DeleteOldExpenses" class="delete">Delete</a>
    <a href="/ExpenseTracker/logout" class="logout">Logout</a>

    <!-- THEME DROPDOWN -->
    <select class="theme-select" id="themeSelect" onchange="applyTheme(this.value)">
      <option value="system">üñ•Ô∏è System</option>
      <option value="light">‚òÄÔ∏è Bright</option>
      <option value="dark">üåô Dark</option>
    </select>
  </div>
</nav>

<div class="container">
  <div class="content-wrapper">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert {{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </div>
</div>

<script>
/* ---- MOBILE MENU ---- */
function toggleMenu(){
  document.getElementById("navMenu").classList.toggle("open");
}

/* ---- SYSTEM THEME DETECTION ---- */
const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

function setSystemTheme(){
  document.body.setAttribute("data-theme", mediaQuery.matches ? "dark" : "light");
}

/* ---- APPLY MODE ---- */
function applyTheme(mode){
  localStorage.setItem("theme-mode", mode);
  document.getElementById("themeSelect").value = mode;

  if(mode === "system"){
    setSystemTheme();
    mediaQuery.addEventListener("change", setSystemTheme);
  } else {
    mediaQuery.removeEventListener("change", setSystemTheme);
    document.body.setAttribute("data-theme", mode);
  }
}

/* ---- LOAD SAVED MODE ---- */
const saved = localStorage.getItem("theme-mode") || "system";
applyTheme(saved);
</script>

</body>
</html>
